# WireViz: Encoder/Limits adapter cable (one axis)
# See stage_wiring.md for design rationale

metadata:
  title: ILEMT Stage - Encoder & Limits Adapter (Per Axis)

connectors:
  DB25:
    type: D-Sub 25 Male
    subtype: male
    notes: Stage cable (from UMI-7774)
    pins: [1, 14, 2, 15, 3, 16, 4, 17, 10, 12, 13, 22, 11]
    pinlabels: [Enc A+, Enc A-, Enc B+, Enc B-, Enc Z+, Enc Z-,
                +5V, Dig GND, Pos Limit, Neg Limit, Viso, Ciso, Home N/C]

  MC508_ENC:
    type: MDR-20
    notes: "MC508 Encoder Port (ATYPE 76)"
    pins: [1, 2, 3, 4, 11, 12, 5, 15, 9, 20, 10]
    pinlabels: [Enc A+, /Enc A, Enc B+, /Enc B, Enc Z+, /Enc Z,
                +5V Enc, 0V, Input A, Input B, Input Com]

  MIC2981:
    type: DIP-18
    notes: "MIC2981/82YN High-Side Source Driver"
    pins: [1, 2, 9, 10, 11, 18]
    pinlabels: [In Pos, In Neg, Vs, GND, Out Pos, Out Neg]

  EXT5V:
    type: Power Supply
    notes: "External 5V (opto-interrupter power)"
    pins: [1, 2]
    pinlabels: ["+5V", GND]

  EXT24V:
    type: Power Supply
    notes: "External 24V (MC508 supply)"
    pins: [1, 2]
    pinlabels: ["+24V", "0V"]

  TIE_0V:
    style: simple
    type: Splice
    notes: "0V tie point"

cables:
  ENC:
    wirecount: 8
    notes: Encoder adapter (8 wires)
    colors: [BK, BN, RD, OG, "#90EE90", LB, YE, WHBN]

  LPOS:
    wirecount: 1
    notes: "Pos limit → MIC2981 in"
    colors: [BU]

  LNEG:
    wirecount: 1
    notes: "Neg limit → MIC2981 in"
    colors: [VT]

  UPOS:
    wirecount: 1
    notes: "MIC2981 out → MC508 Input A"
    colors: [GY]

  UNEG:
    wirecount: 1
    notes: "MIC2981 out → MC508 Input B"
    colors: [WHBU]

  LPWR:
    wirecount: 1
    notes: "Viso → Ext 5V"
    colors: [RD]

  LGND:
    wirecount: 1
    notes: "Ciso → Ext 5V GND"
    colors: [BK]

  # SCSI cable wire from Input Com (pin 10) - white
  ICOM_SCSI:
    wirecount: 1
    notes: "Input Com SCSI wire"
    colors: [WH]

  # Adapter wire from tie point to 24V 0V
  ICOM_TIE:
    wirecount: 1
    notes: "Input Com → 24V 0V"
    colors: [BK]

  V24:
    wirecount: 1
    notes: "+24V → MIC2981 Vs"
    colors: [YE]

  UGND:
    wirecount: 1
    notes: "MIC2981 GND → 24V 0V"
    colors: [BK]

connections:
  # Encoder: DB25 → MC508 (direct, differential)
  -
    - DB25: [1, 14, 2, 15, 3, 16, 4, 17]
    - ENC: [1-8]
    - MC508_ENC: [1, 2, 3, 4, 11, 12, 5, 15]

  # Limit switches: DB25 → MIC2981 inputs
  -
    - DB25: [10]
    - LPOS: [1]
    - MIC2981: [1]
  -
    - DB25: [12]
    - LNEG: [1]
    - MIC2981: [2]

  # MIC2981 outputs → MC508 digital inputs
  -
    - MIC2981: [11]
    - UPOS: [1]
    - MC508_ENC: [9]
  -
    - MIC2981: [18]
    - UNEG: [1]
    - MC508_ENC: [20]

  # MC508 Input Com (WHT SCSI wire) → tie point → 24V 0V
  -
    - MC508_ENC: [10]
    - ICOM_SCSI: [1]
    - TIE_0V: [1]
  -
    - TIE_0V: [1]
    - ICOM_TIE: [1]
    - EXT24V: [2]

  # MIC2981 power: +24V to Vs, 0V to GND (via tie point)
  -
    - EXT24V: [1]
    - V24: [1]
    - MIC2981: [9]
  -
    - MIC2981: [10]
    - UGND: [1]
    - TIE_0V: [1]

  # Opto-interrupter power: Viso/Ciso → External 5V
  -
    - DB25: [13]
    - LPWR: [1]
    - EXT5V: [1]
  -
    - DB25: [22]
    - LGND: [1]
    - EXT5V: [2]
